<section class="cr-hero-carousel">
  <div class="cr-hero-carousel__slides" data-cr-hero-carousel>
    {% for block in section.blocks %}
      <div class="cr-hero-carousel__slide" {{ block.shopify_attributes }}>
        {% if block.settings.image != blank %}
          <div class="cr-hero-carousel__image">
            {{ block.settings.image | image_url: width: 2400 | image_tag: loading: "lazy", class: "cr-hero-carousel__img" }}
          </div>
        {% endif %}

        <div class="cr-hero-carousel__overlay" style="background: {{ block.settings.overlay_color }}; opacity: {{ block.settings.overlay_opacity | divided_by: 100.0 }};"></div>

        <div class="cr-hero-carousel__content">
          {% if block.settings.badge_text != blank %}
            <div class="cr-hero-carousel__badge">{{ block.settings.badge_text }}</div>
          {% endif %}

          <h1 class="cr-hero-carousel__heading">
            <span class="cr-hero-carousel__heading-1">{{ block.settings.heading_part1 }}</span>
            <span class="cr-hero-carousel__heading-2">{{ block.settings.heading_part2 }}</span>
            <span class="cr-hero-carousel__heading-3">{{ block.settings.heading_part3 }}</span>
          </h1>

          {% if block.settings.description != blank %}
            <p class="cr-hero-carousel__description">{{ block.settings.description }}</p>
          {% endif %}

          <div class="cr-hero-carousel__buttons">
            {% if block.settings.primary_button_text != blank and block.settings.primary_button_link != blank %}
              <a class="cr-hero-carousel__btn cr-hero-carousel__btn--primary" href="{{ block.settings.primary_button_link }}">
                {{ block.settings.primary_button_text }}
              </a>
            {% endif %}
            {% if block.settings.secondary_button_text != blank and block.settings.secondary_button_link != blank %}
              <a class="cr-hero-carousel__btn cr-hero-carousel__btn--secondary" href="{{ block.settings.secondary_button_link }}">
                {{ block.settings.secondary_button_text }}
              </a>
            {% endif %}
          </div>
        </div>
      </div>
    {% endfor %}
  </div>

  <div class="cr-hero-carousel__controls">
    <button type="button" class="cr-hero-carousel__control cr-hero-carousel__prev" aria-label="Previous slide">‹</button>
    <button type="button" class="cr-hero-carousel__control cr-hero-carousel__next" aria-label="Next slide">›</button>
  </div>
</section>

<style>
  .cr-hero-carousel { position: relative; overflow: hidden; }
  .cr-hero-carousel__slides { display: flex; transition: transform 450ms ease; will-change: transform; }
  .cr-hero-carousel__slide { min-width: 100%; position: relative; }
  .cr-hero-carousel__image { height: 520px; }
  .cr-hero-carousel__img { width: 100%; height: 100%; object-fit: cover; display: block; }
  .cr-hero-carousel__overlay { position:absolute; inset:0; pointer-events:none; }
  .cr-hero-carousel__content {
    position: absolute; inset: 0;
    display: flex; flex-direction: column; justify-content: center;
    padding: 40px; max-width: 1100px;
  }
  .cr-hero-carousel__badge {
    display: inline-block; margin-bottom: 14px; padding: 8px 14px;
    border-radius: 999px; font-weight: 600;
    background: rgba(16,185,129,.92); color: #fff;
    width: fit-content;
  }
  .cr-hero-carousel__heading { margin: 0 0 10px 0; line-height: 1.05; font-weight: 800; font-size: clamp(32px, 4vw, 64px); color: #fff; }
  .cr-hero-carousel__heading-2 { color: #ff7a2f; }
  .cr-hero-carousel__description { margin: 0 0 18px 0; max-width: 640px; color: rgba(255,255,255,.92); font-size: 16px; }
  .cr-hero-carousel__buttons { display: flex; gap: 12px; flex-wrap: wrap; }
  .cr-hero-carousel__btn { padding: 12px 16px; border-radius: 10px; font-weight: 700; text-decoration: none; }
  .cr-hero-carousel__btn--primary { background: #10b981; color: #fff; }
  .cr-hero-carousel__btn--secondary { background: rgba(255,255,255,.12); color: #fff; border: 1px solid rgba(255,255,255,.35); }
  .cr-hero-carousel__controls { position: absolute; inset: auto 18px 18px auto; display: flex; gap: 8px; }
  .cr-hero-carousel__control { width: 44px; height: 44px; border-radius: 12px; border: 1px solid rgba(255,255,255,.25); background: rgba(0,0,0,.35); color: #fff; font-size: 24px; cursor: pointer; }
</style>

<script>
  (function() {
    const root = document.querySelector('[data-cr-hero-carousel]');
    if (!root) return;

    const slides = root.children;
    const total = slides.length;
    if (total <= 1) return;

    let index = 0;

    const update = () => {
      root.style.transform = 'translateX(' + (-index * 100) + '%)';
    };

    const prevBtn = root.closest('.cr-hero-carousel').querySelector('.cr-hero-carousel__prev');
    const nextBtn = root.closest('.cr-hero-carousel').querySelector('.cr-hero-carousel__next');

    prevBtn && prevBtn.addEventListener('click', () => {
      index = (index - 1 + total) % total;
      update();
    });

    nextBtn && nextBtn.addEventListener('click', () => {
      index = (index + 1) % total;
      update();
    });
  })();
</script>

{% schema %}
{
  "name": "Rigging Hero Carousel",
  "max_blocks": 8,
  "blocks": [
    {
      "type": "slide",
      "name": "Slide",
      "settings": [
        { "type": "image_picker", "id": "image", "label": "Background image" },
        { "type": "text", "id": "badge_text", "label": "Badge text", "default": "Custom Rigging Experts" },
        { "type": "text", "id": "heading_part1", "label": "Heading part 1", "default": "Tournament-Ready" },
        { "type": "text", "id": "heading_part2", "label": "Heading part 2 (highlight)", "default": "Fishing Kayaks" },
        { "type": "text", "id": "heading_part3", "label": "Heading part 3", "default": "Shipped Nationwide" },
        { "type": "textarea", "id": "description", "label": "Description", "default": "Professional rigging by Crystal Coast experts. Turnkey builds from $3k to $13k+ delivered to your door." },
        { "type": "text", "id": "primary_button_text", "label": "Primary button text", "default": "Browse Rigging Packages" },
        { "type": "url", "id": "primary_button_link", "label": "Primary button link" },
        { "type": "text", "id": "secondary_button_text", "label": "Secondary button text", "default": "Build Custom Rig" },
        { "type": "url", "id": "secondary_button_link", "label": "Secondary button link" },
        { "type": "color", "id": "overlay_color", "label": "Overlay color", "default": "#0B3A66" },
        { "type": "range", "id": "overlay_opacity", "label": "Overlay opacity", "min": 0, "max": 90, "step": 5, "unit": "%", "default": 55 }
      ]
    }
  ],
  "presets": [
    { "name": "Rigging Hero Carousel", "blocks": [{ "type": "slide" }] }
  ]
}
{% endschema %}
